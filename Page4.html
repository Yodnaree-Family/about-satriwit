<!DOCTYPE html><!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.1 ‡πÅ‡∏•‡∏∞ ‡∏°.4 ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

    <style>
        body::before {
    content: "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ‚ù§Ô∏è‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤";
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-30deg);
    font-size: 5rem;
    font-weight: 600;
    color: rgba(0, 0, 0, 0.05); /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏à‡∏≤‡∏á ‡πÜ */
    white-space: nowrap;
    pointer-events: none; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏•‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ */
    z-index: 0;
}
        body {
            font-family: 'Sarabun', sans-serif;
        }
        .main-tab-active {
            border-bottom-color: #c53030;
            color: #c53030;
            font-weight: 700;
        }
        .sub-tab-active {
            background-color: #f56565;
            color: white;
        }
        .program-tab-active {
            background-color: #fed7d7;
            color: #9b2c2c;
            border-color: #f56565;
            font-weight: 600;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 45vh;
            width: 100%;
        }
        th {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        /* For custom border colors */
        .border-l-custom {
            border-left-width: 4px;
        }
        
    /* ======= ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å ======= */
.dropdown-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: white;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  z-index: 1000;
  text-align: center;
  padding: 0.6rem 0;
}

.dropdown-wrapper {
  position: relative;
  display: inline-block;
}

.dropdown-btn {
  /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° (Maroon) */
  background: #a01a1a;
  color: white;
  font-weight: 700;
  border: none;
  padding: 0.7rem 1.6rem;
  border-radius: 10px;
  cursor: pointer;
  font-size: 1.2rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  transition: all 0.25s ease;
}
.dropdown-btn:hover {
  transform: scale(1.07);
  box-shadow: 0 6px 18px rgba(0,0,0,0.25);
}

/* ‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á */
.dropdown-menu {
  position: absolute;
  left: 0;
  margin-top: 0.6rem;
  width: 270px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  overflow: hidden;
  opacity: 0;
  transform: translateY(-15px);
  pointer-events: none;
  transition: all 0.35s ease;
  border-top: 4px solid #b91c1c;
}
.dropdown-menu.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.dropdown-menu a {
  display: block;
  padding: 10px 16px;
  color: #b91c1c;
  font-weight: 600;
  text-decoration: none;
  background: white;
  transition: all 0.25s ease;
}
.dropdown-menu a:hover {
  background: #fee2e2;
  color: #7f1d1d;
  padding-left: 22px;
}

/* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
@media (max-width: 768px) {
  .dropdown-menu {
    position: fixed;
    top: 70px;
    left: 50%;
    transform: translateX(-50%) translateY(-10px);
    width: 90%;
    border-radius: 14px;
    box-shadow: 0 12px 25px rgba(0,0,0,0.3);
  }
  .dropdown-menu.show {
    transform: translateX(-50%) translateY(0);
  }
  .dropdown-btn {
    font-size: 1.1rem;
    padding: 0.6rem 1.2rem;
  }
}

    </style>
    </head>
<body class="font-sans text-gray-800 pt-[80px]">
<!-- ‚úÖ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å -->
<div class="dropdown-container flex justify-start pl-4">
  <div class="dropdown-wrapper relative inline-block">
    <button id="dropdownButton" class="dropdown-btn">
      ‚ò∞ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å
    </button>
    <div id="dropdownMenu" class="dropdown-menu hidden">
      <a href="index.html">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ</a>
      <a href="Page5.html">üìò ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</a>
      <a href="Page2.html">üìñ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</a>
      <a href="Page3.html">üìä ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</a>
      <a href="Page4.html">üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</a>
      <a href="Page6.html">üß≠ ‡πÅ‡∏ú‡∏ô‡∏•‡∏±‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏°.1</a>
      <a href="‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢.html">üßÆ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</a>
      <a href="Page7.html">üóìÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.1</a>
      <a href="‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏°.1.html">üìö ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</a>
      <a href="‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥.html">üìë ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</a>
    </div>
  </div>
</div>

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-red-800">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</h1>
            <p class="text-gray-600 mt-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô ‡∏°.1 ‡πÅ‡∏•‡∏∞ ‡∏°.4</p>
        </header>

        <!-- Main Tabs -->
        <div class="border-b border-gray-200 mb-6">
            <nav class="flex justify-center -mb-px space-x-4 md:space-x-8" aria-label="Tabs">
                <button class="main-tab py-4 px-1 border-b-2 font-medium text-lg text-blue-800 hover:text-red-700 hover:border-red-400" data-level="m1">
                    ‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1
                </button>
                <button class="main-tab py-4 px-1 border-b-2 font-medium text-lg text-blue-800 hover:text-red-700 hover:border-red-400" data-level="m4">
                    ‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4
                </button>
            </nav>
        </div>

        <!-- Sub Tabs Container -->
        <div id="sub-tabs-container" class="text-center mb-8"></div>

        <!-- Content Display Area -->
        <div id="content-area" class="space-y-12"></div>
        
        <footer class="text-center mt-12 text-gray-600">
            <p class="font-normal text-base">‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢.. ‡∏•‡∏∏‡πâ‡∏ô‡∏™‡∏≠‡∏ß‡∏≠‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞</p>
            <p class="font-normal text-base">‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏¢‡∏≠‡∏î‡∏ô‡∏≤‡∏£‡∏µ‚ù§Ô∏è‡∏™‡∏ï‡∏£‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</p>
            <a href="https://shorturl.asia/BlJVn" target="_blank" class="mt-3 mb-4 inline-flex items-center gap-2 font-semibold text-green-600 hover:underline text-lg">
                <i class="fab fa-line text-2xl"></i> Line OPC
            </a>
        </footer>
    </div>

    <script>
        const colorPalette = ['#d53f8c', '#3182ce', '#38a169', '#dd6b20', '#805ad5', '#319795'];
        const colorPaletteLight = ['#fbb6ce', '#a3bfed', '#9ae6b4', '#fbd38d', '#d6bcfa', '#90cdf4'];
        
        // --- DATASET ---
        const admissionData = {
          m1: {
            special: {
              title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏°.1",
              programs: {
                'Gifted - Math': { years: [2568, 2567, 2566, 2565, 2564, 2563], accepted: [72, 72, 72, 72, 102, 102], applicants: [384, 308, 337, 358, 391, 444], rate: [5.33, 4.28, 4.68, 4.97, 3.83, 4.35] },
                'SMTE': { years: [2568, 2567, 2566, 2565], accepted: [30, 30, 30, 30], applicants: [171, 101, 102, 120], rate: [5.70, 3.37, 3.40, 4.00] },
                'EP': { years: [2568, 2567, 2566, 2565, 2564, 2563], accepted: [60, 60, 60, 60, 60, 60], applicants: [273, 182, 155, 250, 217, 254], rate: [4.55, 3.03, 2.58, 4.17, 3.62, 4.23] }
              }
            },
            regular: {
              title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏°.1",
              programs: {
                '‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£': { years: [2568, 2567, 2566, 2565, 2564], accepted: [30, 30, 46, 66, 63], applicants: [61, 54, 59, 87, 131], rate: [2.03, 1.80, 1.28, 1.32, 2.08] },                
                '‡∏ô‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£': { years: [2568, 2567, 2566, 2565, 2564], accepted: [265, 265, 236, 250, 269], applicants: [913, 721, 537, 759, 648], rate: [3.45, 2.72, 2.28, 3.04, 2.41] },
                '‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏©': { years: [2568, 2567, 2566, 2565, 2564], accepted: [45, 45, 45, 39, 40], applicants: [45, 45, 45, 39, 40], rate: [1.00, 1.00, 1.00, 1.00, 1.00] },
                '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©': { years: [2568, 2567, 2566, 2565, 2564], accepted: [20, 16, 18, 9, 10], applicants: [93, 47, 34, 24, 22], rate: [4.65, 2.94, 1.89, 2.67, 2.20] }
              }
            }
          },
          m4: {
            special: {
              title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏°.4",
              programs: {
                'SMTE': { years: [2568, 2567, 2566, 2565, 2564, 2563], accepted: [30, 30, 30, 30, 30, 30], applicants: [247, 141, 133, 153, 121, 127], rate: [8.23, 4.70, 4.43, 5.10, 4.03, 4.23] },
                'EP': { years: [2568, 2567, 2566, 2565, 2564, 2563], accepted: [15, 15, 15, 15, 10, 10], applicants: [68, 48, 45, 55, 35, 48], rate: [4.53, 3.20, 3.00, 3.67, 3.50, 4.80] }
              }
            },
            regular: {
              title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏°.4",
              programs: {
                '‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï': { years: [2568, 2567, 2566], accepted: [12, 15, 20], applicants: [280, 285, 197], rate: [23.33, 19.00, 9.85] },
                '‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ì‡∏¥‡∏ï-‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì': { years: [2568, 2567], accepted: [10, 10], applicants: [88, 82], rate: [8.80, 8.20] },
                '‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤-‡∏™‡∏´‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£': { years: [2568, 2567, 2566], accepted: [3, 10, 10], applicants: [30, 62, 40], rate: [10.00, 6.20, 4.00] }
              }
            }
          }
        };

        const mainTabs = document.querySelectorAll('.main-tab');
        const subTabsContainer = document.getElementById('sub-tabs-container');
        const contentArea = document.getElementById('content-area');

        let currentLevel = 'm1';
        let currentType = 'special';
        let applyAcceptChartInstance, rateChartInstance;

        function setupSubTabs() {
            subTabsContainer.innerHTML = `
                <div class="inline-flex rounded-lg shadow-sm" role="group">
                    <button type="button" class="sub-tab py-2 px-4 text-sm font-medium text-grey-500 bg-grey rounded-l-lg border border-gray-400 hover:bg-gray-100 hover:text-grey-400" data-type="special">
                        ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©
                    </button>
                    <button type="button" class="sub-tab py-2 px-4 text-sm font-medium text-grey-500 bg-grey rounded-r-lg border border-gray-400 hover:bg-gray-100 hover:text-grey-400" data-type="regular">
                        ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
                    </button>
                </div>
            `;
            document.querySelectorAll('.sub-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    currentType = tab.dataset.type;
                    updateView();
                });
            });
        }

        function renderContent() {
            const data = admissionData[currentLevel][currentType];
            const allYears = [...new Set(Object.values(data.programs).flatMap(p => p.years))].filter(y => y).sort((a, b) => b - a);
            const programs = Object.keys(data.programs);

            // --- 1. TABLE ---
            let tableHtml = `
                <section id="data-table" class="bg-white p-4 sm:p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">${data.title}</h2>
                    <div class="overflow-x-auto max-h-[500px]">
                        <table class="w-full text-sm text-center text-gray-600">
                            <thead class="text-xs text-white uppercase">
                                <tr class="bg-red-800">
                                    <th scope="col" class="py-3 px-6 rounded-tl-lg sticky left-0 bg-red-800 z-20">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£/‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                    ${allYears.map(year => `<th scope="col" colspan="3" class="py-3 px-6 border-l border-red-600">${year}</th>`).join('')}
                                </tr>
                                <tr class="bg-red-700">
                                    <th scope="col" class="py-3 px-2 sticky left-0 bg-red-700 z-20"></th>
                                    ${allYears.map(() => `
                                        <th class="py-2 px-2 font-medium border-l border-red-500">‡∏£‡∏±‡∏ö</th>
                                        <th class="py-2 px-2 font-medium">‡∏™‡∏°‡∏±‡∏Ñ‡∏£</th>
                                        <th class="py-2 px-2 font-medium">‡∏≠‡∏±‡∏ï‡∏£‡∏≤</th>
                                    `).join('')}
                                </tr>
                            </thead>
                            <tbody>`;
            programs.forEach((programName, progIdx) => {
                const progColor = colorPalette[progIdx % colorPalette.length];
                const rowClass = progIdx % 2 === 0 ? 'bg-white' : 'bg-red-50';
                tableHtml += `<tr class="${rowClass} border-b border-red-100 hover:bg-red-100 transition-colors duration-200">
                                <th scope="row" class="py-4 px-6 font-medium text-gray-900 text-left sticky left-0 ${rowClass} z-10 border-l-custom" style="border-left-color: ${progColor};">${programName}</th>`;
                const programData = data.programs[programName];
                allYears.forEach(year => {
                    const yearIndex = programData.years.indexOf(year);
                    if (yearIndex !== -1) {
                        tableHtml += `
                            <td class="py-4 px-2 border-l border-indigo-500">${programData.accepted[yearIndex] ?? '-'}</td>
                            <td class="py-4 px-2">${programData.applicants[yearIndex] ?? '-'}</td>
                            <td class="py-4 px-2 font-semibold">${programData.rate[yearIndex] ? (programData.rate[yearIndex]).toFixed(2) : '-'}</td>`;
                    } else {
                        tableHtml += `<td class="py-4 px-2 border-l border-gray-200">-</td><td class="py-4 px-2">-</td><td class="py-4 px-2">-</td>`;
                    }
                });
                tableHtml += `</tr>`;
            });
            tableHtml += `</tbody></table></div>`;

            // Add note for M.1 Special programs
            if (currentLevel === 'm1' && currentType === 'special') {
                tableHtml += `
                    <div class="mt-4 text-sm text-gray-800 p-3 bg-yellow-100 border-l-4 border-yellow-500 rounded-r-lg">
                        <p><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô Gifted Math ‡πÅ‡∏•‡∏∞ SMTE ‡∏õ‡∏µ 2565 ‡πÅ‡∏•‡∏∞‡∏õ‡∏µ 2566 ‡∏¢‡∏≠‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≠‡∏ö‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô</p>
                    </div>
                `;
            }

            tableHtml += `</section>`;

            // --- 2. APPLICANT VS ACCEPTED CHART ---
            let barChartHtml = `
                <section id="applicant-chart" class="bg-white p-4 sm:p-6 rounded-xl shadow-lg">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4">
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏±‡∏ö</h2>
                            <p class="text-sm text-gray-500">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</p>
                        </div>
                        <select id="year-selector" class="mt-2 sm:mt-0 form-select rounded-md border-gray-300 shadow-sm focus:border-red-300 focus:ring focus:ring-red-200 focus:ring-opacity-50">
                            ${allYears.map(year => `<option value="${year}">${year}</option>`).join('')}
                        </select>
                    </div>
                    <div class="chart-container">
                        <canvas id="applyAcceptChart"></canvas>
                    </div>
                </section>`;
            
            // --- 3. COMPETITION RATE CHART ---
            let lineChartHtml = `
                <section id="rate-chart" class="bg-white p-4 sm:p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold text-gray-800 mb-1">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</h2>
                    <p class="text-sm text-gray-500 mb-4">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ</p>
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${programs.map((p) => `
                            <button class="program-tab py-2 px-4 text-sm font-medium text-gray-700 bg-Light Blue rounded-lg border border-gray-200 hover:bg-gray-100" data-program="${p}">
                                ${p}
                            </button>
                        `).join('')}
                    </div>
                    <div class="chart-container">
                        <canvas id="rateChart"></canvas>
                    </div>
                </section>`;

            contentArea.innerHTML = tableHtml + barChartHtml + lineChartHtml;
            
            document.getElementById('year-selector').addEventListener('change', (e) => updateBarChart(e.target.value));
            document.querySelectorAll('.program-tab').forEach(tab => tab.addEventListener('click', (e) => updateLineChart(e.currentTarget.dataset.program)));

            updateBarChart(allYears[0]);
            updateLineChart(programs[0]); 
        }

        function updateBarChart(year) {
            const yearNum = parseInt(year);
            const data = admissionData[currentLevel][currentType];
            const labels = Object.keys(data.programs);
            
            const applicantData = labels.map(p => {
                const yearIndex = data.programs[p].years.indexOf(yearNum);
                return (yearIndex !== -1 && data.programs[p].applicants[yearIndex] !== null) ? data.programs[p].applicants[yearIndex] : 0;
            });
            const acceptedData = labels.map(p => {
                const yearIndex = data.programs[p].years.indexOf(yearNum);
                return (yearIndex !== -1 && data.programs[p].accepted[yearIndex] !== null) ? data.programs[p].accepted[yearIndex] : 0;
            });

            if (applyAcceptChartInstance) applyAcceptChartInstance.destroy();
            const ctx = document.getElementById('applyAcceptChart').getContext('2d');
            applyAcceptChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels,
                    datasets: [
                        { label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£', data: applicantData, backgroundColor: labels.map((_,i) => colorPalette[i % colorPalette.length]), borderWidth: 1 },
                        { label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö', data: acceptedData, backgroundColor: labels.map((_,i) => colorPaletteLight[i % colorPaletteLight.length]), borderWidth: 1 }
                    ]
                },
                options: { maintainAspectRatio: false, responsive: true, scales: { y: { beginAtZero: true } }, plugins: { title: { display: true, text: `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${year}` } } }
            });
        }
        
        function updateLineChart(programName) {
            const programs = Object.keys(admissionData[currentLevel][currentType].programs);
            const programIndex = programs.indexOf(programName);
            const progColor = colorPalette[programIndex % colorPalette.length];
            const progColorLight = colorPaletteLight[programIndex % colorPaletteLight.length];
            
            document.querySelectorAll('.program-tab').forEach(tab => {
                tab.classList.toggle('program-tab-active', tab.dataset.program === programName);
            });

            const data = admissionData[currentLevel][currentType].programs[programName];
            const sortedData = data.years
                .map((year, index) => ({ year, rate: data.rate[index] }))
                .filter(item => item.rate !== null && item.year !== null)
                .sort((a, b) => a.year - b.year);

            const labels = sortedData.map(item => item.year);
            const rateData = sortedData.map(item => item.rate);

            if (rateChartInstance) rateChartInstance.destroy();
            const ctx = document.getElementById('rateChart').getContext('2d');
            rateChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: `‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô: ${programName}`,
                        data: rateData,
                        borderColor: progColor,
                        backgroundColor: progColorLight,
                        tension: 0.2,
                        fill: true,
                        pointBackgroundColor: progColor,
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: { maintainAspectRatio: false, responsive: true, scales: { y: { beginAtZero: true, title: { display: true, text: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô (X : 1)' } } } }
            });
        }

        function updateView() {
            mainTabs.forEach(tab => {
                tab.classList.toggle('main-tab-active', tab.dataset.level === currentLevel);
                tab.classList.toggle('border-transparent', tab.dataset.level !== currentLevel);
            });
            document.querySelectorAll('.sub-tab').forEach(tab => {
                tab.classList.toggle('sub-tab-active', tab.dataset.type === currentType);
            });
            renderContent();
        }

        mainTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                currentLevel = tab.dataset.level;
                currentType = 'special'; 
                updateView();
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Set the first main tab as active on initial load
            const firstMainTab = document.querySelector('.main-tab');
            if(firstMainTab) {
                firstMainTab.classList.add('main-tab-active');
                firstMainTab.classList.remove('border-transparent');
            }
            
            setupSubTabs();
            updateView();
        });

    </script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const button = document.getElementById("dropdownButton");
  const menu = document.getElementById("dropdownMenu");
  let isOpen = false;

  button.addEventListener("click", (e) => {
    e.stopPropagation();
    isOpen = !isOpen;
    if (isOpen) {
      button.innerHTML = "‚úñ ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π";
      menu.classList.remove("hidden");
      setTimeout(() => menu.classList.add("show"), 10);
    } else {
      button.innerHTML = "‚ò∞ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å";
      menu.classList.remove("show");
      setTimeout(() => menu.classList.add("hidden"), 300);
    }
  });

  document.addEventListener("click", (e) => {
    if (!menu.contains(e.target) && !button.contains(e.target)) {
      if (isOpen) {
        isOpen = false;
        button.innerHTML = "‚ò∞ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å";
        menu.classList.remove("show");
        setTimeout(() => menu.classList.add("hidden"), 300);
      }
    }
  });
});
</script>

</body>
</html>
